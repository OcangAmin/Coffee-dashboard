<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kasir Nasi Kuning 51</title>

<style>
body{font-family:Arial;background:#f4f4f4;margin:0;padding:10px}
h2,h3{margin:6px 0}
.box{background:#fff;padding:12px;border-radius:10px;margin-bottom:12px}
button{padding:10px;border:none;border-radius:8px;font-size:14px;cursor:pointer}
.menu-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
.menu-btn{background:#ffc107;font-weight:bold}
.metode-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:6px}
.metode-btn{background:#dee2e6}
.metode-aktif{background:#0d6efd;color:#fff}
.nominal-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:6px}
.nominal-btn{background:#198754;color:#fff;font-weight:bold}
.hapus{background:#dc3545;color:#fff}
.simpan{background:#0d6efd;color:#fff;width:100%;margin-top:8px}
.hidden{display:none}
table{width:100%;border-collapse:collapse}
td,th{border-bottom:1px solid #ddd;padding:6px;text-align:center}
input{width:100%;padding:8px;margin-top:6px;font-size:16px}
.summary{background:#e9ecef;padding:8px;border-radius:8px}
</style>
</head>

<body>

<!-- KAS AWAL -->
<div class="box" id="kasAwalBox">
  <h2>üí∞ Kas Awal</h2>
  <input type="number" id="kasAwal" placeholder="Masukkan kas awal">
  <button class="simpan" onclick="simpanKasAwal()">Mulai Kasir</button>
</div>

<!-- KASIR -->
<div id="kasirBox" class="hidden">

<h2>üçõ Kasir Nasi Kuning 51</h2>

<div class="box">
<h3>Menu</h3>
<div id="menu" class="menu-grid"></div>
</div>

<div class="box">
<h3>Transaksi</h3>
<table id="tabel">
<tr><th>Menu</th><th>Qty</th><th>Subtotal</th><th></th></tr>
</table>

<h3>Total: Rp <span id="total">0</span></h3>

<h3>Metode Pembayaran</h3>
<div class="metode-grid">
  <button id="btnCash" class="metode-btn" onclick="pilihMetode('Cash')">CASH</button>
  <button id="btnQris" class="metode-btn" onclick="pilihMetode('QRIS')">QRIS</button>
</div>

<input type="number" id="bayar" placeholder="Uang dibayar" oninput="hitungKembalian()">

<div class="nominal-grid">
  <button class="nominal-btn" onclick="setBayar(5000)">5.000</button>
  <button class="nominal-btn" onclick="setBayar(10000)">10.000</button>
  <button class="nominal-btn" onclick="setBayar(20000)">20.000</button>
  <button class="nominal-btn" onclick="setBayar(50000)">50.000</button>
  <button class="nominal-btn" onclick="setBayar(100000)">100.000</button>
  <button class="nominal-btn" onclick="uangPas()">UANG PAS</button>
</div>

<h3>Kembalian: Rp <span id="kembali">0</span></h3>

<button class="simpan" onclick="selesaikanTransaksi()">‚úî Selesaikan Transaksi</button>
</div>

<div class="box">
<h3>üìú Histori Pembayaran</h3>
<div id="histori"></div>

<button class="simpan" onclick="simpanKeFile()">üíæ Simpan TOTAL Transaksi</button>
</div>

<div class="box summary">
<b>üìä Rekap Hari Ini</b><br>
Transaksi: <span id="rJml">0</span><br>
Omzet: Rp <span id="rOmzet">0</span><br>
Kembalian: Rp <span id="rKembali">0</span>
</div>

</div>

<script>
const menuData=[
["Ikan",5000],["Bakwan",2000],["Nasi",5000],["Telur",5000],
["Ayam",5000],["Nasi kuning ayam",15000],["Nasi kuning ikan",13000],
["Nasi kuning telur",10000],["Nasi kuning ayam telur",23000],
["Nasi kuning ikan telur",20000],["Air mineral",5000]
];

let cart=[], histori=[], metode="";

function simpanKasAwal(){
  if(!kasAwal.value) return alert("Isi kas awal!");
  localStorage.setItem("kasAwal",kasAwal.value);
  kasAwalBox.classList.add("hidden");
  kasirBox.classList.remove("hidden");
}

menuData.forEach(m=>{
  let b=document.createElement("button");
  b.className="menu-btn";
  b.innerHTML=`${m[0]}<br>Rp${m[1]}`;
  b.onclick=()=>tambah(m[0],m[1]);
  menu.appendChild(b);
});

function tambah(n,h){
  let i=cart.find(c=>c.nama===n);
  i?i.qty++:cart.push({nama:n,harga:h,qty:1});
  render();
}

function hapus(n){
  cart=cart.filter(c=>c.nama!==n);
  render();
}

function render(){
  tabel.innerHTML="<tr><th>Menu</th><th>Qty</th><th>Subtotal</th><th></th></tr>";
  let t=0;
  cart.forEach(c=>{
    let s=c.harga*c.qty;
    t+=s;
    tabel.innerHTML+=`
    <tr>
      <td>${c.nama}</td>
      <td>${c.qty}</td>
      <td>${s}</td>
      <td><button class="hapus" onclick="hapus('${c.nama}')">X</button></td>
    </tr>`;
  });
  total.innerText=t;
  hitungKembalian();
}

function pilihMetode(m){
  metode=m;
  btnCash.classList.remove("metode-aktif");
  btnQris.classList.remove("metode-aktif");
  m==="Cash"?btnCash.classList.add("metode-aktif"):btnQris.classList.add("metode-aktif");
  if(m==="QRIS") uangPas();
}

function setBayar(n){
  bayar.value=Number(n);
  hitungKembalian();
}

function uangPas(){
  bayar.value=Number(total.innerText);
  hitungKembalian();
}

function hitungKembalian(){
  let k=Number(bayar.value)-Number(total.innerText);
  kembali.innerText=k>0?k:0;
}

function selesaikanTransaksi(){
  if(cart.length===0) return alert("Transaksi kosong");
  if(!metode) return alert("Pilih metode pembayaran");

  histori.push({
    waktu:new Date().toLocaleString("id-ID"),
    total:Number(total.innerText),
    kembali:Number(kembali.innerText),
    metode:metode
  });

  tampilHistori();
  cart=[];render();
  bayar.value="";kembali.innerText=0;
}

function tampilHistori(){
  histori.innerHTML=histori.map(h=>`
    <div>${h.waktu} | ${h.metode} | Rp${h.total} | Kembali Rp${h.kembali}</div>
  `).join("");
  hitungRekap();
}

function hitungRekap(){
  let o=0,k=0;
  histori.forEach(h=>{o+=h.total;k+=h.kembali});
  rJml.innerText=histori.length;
  rOmzet.innerText=o;
  rKembali.innerText=k;
}

function simpanKeFile(){
  let t=new Date().toLocaleDateString("id-ID").replace(/\//g,"-");
  let isi=`Kas Awal: Rp${localStorage.getItem("kasAwal")}\n\n`;
  histori.forEach(h=>{
    isi+=`${h.waktu} | ${h.metode} | Total Rp${h.total} | Kembali Rp${h.kembali}\n`;
  });
  isi+=`\nTotal Transaksi: ${rJml.innerText}`;
  isi+=`\nOmzet: Rp${rOmzet.innerText}`;
  isi+=`\nKembalian: Rp${rKembali.innerText}`;

  let a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([isi],{type:"text/plain"}));
  a.download="kasir_nasi_kuning_51_"+t+".txt";
  a.click();
}
</script>

</body>
</html>
